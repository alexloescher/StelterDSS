@model Ingeniux.Runtime.CMSPageRequest
@using Ingeniux.Runtime
@{
    var siteControl = Model.Element("CSiteControl");
    bool isMobile = _Functions.isMobile(Model);
    bool shouldUseAdaptiveMobile = siteControl != null && siteControl.GetElementValue("EnableAdaptiveMode") == "true";
    bool bootstrapOverride = siteControl != null && siteControl.GetElementValue("DisplayMode") == "Adaptive" && (isMobile && shouldUseAdaptiveMobile);

    if (bootstrapOverride)
    {
        @Html.Partial("PageLayout/VerticalNavigation", siteControl)
    } 
    else if (siteControl != null) {
        var scLeftComps = siteControl.Elements().Where(ele => ele.GetAttributeValue("Name") == "LeftItem");
        if (scLeftComps.Any())
        {
            foreach (var comp in scLeftComps)
            {
                string compName = (comp as CMSPageRequest).RootElementName;
                try
                {
                    ViewDataDictionary dict = new ViewDataDictionary { { "ContainerId", comp.GetElementValue("ContainerId") },
                                                    { "ContainerClass", comp.GetElementValue("ContainerClass") },
                                                    { "ContainerLocalStyle", comp.GetElementValue("ContainerLocalStyle") }
                                                };

                    if (compName.Equals("NavigationComponent")) {
                        Html.RenderPartial("Components/NavigationComponent", siteControl, dict);
                    } else if (compName.Equals("CalloutComponent")) {
                        Html.RenderPartial("Other/LinkSetField", new ViewDataDictionary(Model.XPathSelectElement("/*/CSiteControl/LinkSet[@Name='Callout']")));
                        Html.RenderPartial("Other/LinkSetField", new ViewDataDictionary(Model.XPathSelectElement("/*/LinkSet[@Name='Callout']")));
                    } else if (compName.Equals("SocialComponent")) {
                        Html.RenderPartial("Other/SocialHub", siteControl.Element("SocialHub"), dict);
                    } else if (compName.Equals("WhatsNewComponent")) {
                        Html.RenderPartial("Components/WhatsnewComponent", Model.Page, dict);
                    } else {
                        Html.RenderPartial("Components/" + compName, comp);
                    }
                }
                catch (Exception e)
                {
                    // no view for this component or exception
                    <!-- Error rendering component @compName: @e.Message -->
                }
            }
        }
    }
}