@model Ingeniux.Runtime.CMSPageRequest
@using Ingeniux.Runtime
@{
    var siteControl = Model.Element("CSiteControl");
    var pgRightComps = Model.Elements().Where(ele => ele.GetAttributeValue("Name") == "RightItem");
    if (pgRightComps.Any())
    {
        foreach (var comp in pgRightComps)
        {
            string compName = (comp as CMSPageRequest).RootElementName;
            try
            {
                ViewDataDictionary dict = new ViewDataDictionary { { "ContainerId", comp.GetElementValue("ContainerId") },
                                                    { "ContainerClass", comp.GetElementValue("ContainerClass") },
                                                    { "ContainerLocalStyle", comp.GetElementValue("ContainerLocalStyle") },
                                                    { "IncludeDivider", true }
                                                };

                if (compName.Equals("NavigationComponent") && siteControl != null)
                {
                    Html.RenderPartial("Components/NavigationComponent", siteControl, dict);
                }
                else if (compName.Equals("CalloutComponent"))
                {
                    Html.RenderPartial("Other/LinkSetField", new ViewDataDictionary(Model.XPathSelectElement("/*/CSiteControl/LinkSet[@Name = 'Callout']")));
                    Html.RenderPartial("Other/LinkSetField", new ViewDataDictionary(Model.XPathSelectElement("/*/LinkSet")));
                }
                else if (compName.Equals("SocialComponent") && siteControl != null)
                {
                    Html.RenderPartial("Other/SocialHub", siteControl.Element("SocialHub"), dict);
                }
                else if (compName.Equals("WhatsNewComponent"))
                {
                    Html.RenderPartial("Components/WhatsnewComponent", Model.Page, dict);
                }
                else 
                {
                    Html.RenderPartial("Components/" + compName, comp);
                }
            }
            catch (Exception e)
            {
                // no view for this component or exception
            }
        }
    }
}